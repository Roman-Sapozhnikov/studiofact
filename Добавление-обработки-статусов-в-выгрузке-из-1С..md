Добавление обработки статусов в выгрузке из 1С.

1. Необходимо наследовать класс CSaleOrderLoader.
2. Переопределить метод nodeHandler, скопировав в новый метод код из ядра.
3. Добавить код  для обработки статусов перед записью полей заказа в базу.

` if (count($arAditFields) > 0) {   \CSaleOrder::Update($orderId, $arAditFields); } `

Пример кода для обработки:
`function nodeHandler(\CDataXML $value)
    {
        $value = $value->GetArray();

        $agVal = $value[GetMessage("CC_BSC1_DOCUMENT")]["#"][GetMessage("CC_BSC1_AGENTS")][0]['#'];


        if (!empty($value[GetMessage("CC_BSC1_DOCUMENT")])) {
            $value = $value[GetMessage("CC_BSC1_DOCUMENT")];
            $this->counter++;
            /* if ((($this->counter) % $this->ordersByStep == 0) && ($this->counter > $this->ordersByStep))
            {
                sleep(5);
            }*/

            $arOrder = $this->collectOrderInfo($value);


            if (!empty($arOrder)) {
              ...
                            /*
                             * Process agent order properties.
                             */


                            if (!empty($arOrder['TRAITS'])) {

                                foreach ($arOrder['TRAITS'] as $key => $propValue) {

                                    switch ($key) {
                                        case GetMessage("SFP_ORDER_STATUS_ID"):
                                            $arAditFields["STATUS_ID"] = $propValue;
                                            $arAditFields["UPDATED_1C"] = "Y";
                                            break;
                                        default:
                                            break;
                                    }
                                }
                            }


                            $arAgentInfo = $this->collectAgentInfo($agVal[GetMessage("CC_BSC1_AGENT")][0]["#"]);


                            if (count($arAditFields) > 0) {
                                \CSaleOrder::Update($orderId, $arAditFields);
                            }


                        }
                    } else {
                        ...
        }
    }`